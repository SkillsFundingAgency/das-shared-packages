@using SFA.DAS.Provider.Shared.UI.Models

<script nws-csp-add-nonce="true">
    @if (ViewBag.GaData == null)
    {
        ViewBag.GaData = new GaData();
    }
    window.dataLayer = window.dataLayer || [];
    dataLayer.push({
        'event': '@ViewBag.GaData.DataLoaded',
        'vpv': '@ViewBag.GaData.Vpv',
        'org': '@ViewBag.GaData.Org',
        'UserID': '@ViewBag.GaData.UserId',
        'Account': '@ViewBag.GaData.UkPrn'
        @if (ViewBag.GaData.Extras.Count>0)
        {
            @Html.Raw(",");
        }
        @{
            var count = 0;
            foreach (var extra in ViewBag.GaData.Extras)
            {
                count++;
                @Html.Raw($"'{extra.Key}' : '{extra.Value}'");
                if (count < ViewBag.GaData.Extras.Count)
                {
                    @Html.Raw("," + Environment.NewLine);
                }
            }
        }
    });
</script>